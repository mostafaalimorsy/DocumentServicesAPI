
# ğŸ“„ Document Services API

A .NET 6-based backend service for uploading, converting, annotating, and retrieving documents (PDF, DOCX, XLSX, TXT, Images). The service authenticates users via IAM and uses token-based authorization for all endpoints.

---

## ğŸ“¦ Project Structure (Clean Architecture)

This solution follows **Clean Architecture** principles and is organized by responsibility layers:

```
DocumentServices.sln
â”‚
â”œâ”€â”€ DocumentServices             # ASP.NET Core Web API (Presentation Layer)
â”œâ”€â”€ DocumentServices.Application      # Application Layer (Services, Interfaces, DTOs, Business Logic)
â”œâ”€â”€ DocumentServices.Domain           # Domain Layer (Entities, Enums, Core Abstractions)
â””â”€â”€ DocumentServices.Infrastructure   # Infrastructure Layer (File System, IAM, Aspose, Validators, Repositories)
```

---

## ğŸ§° Technologies Used

- **.NET 6**
- **ASP.NET Core Web API**
- **IAM Token Authentication** (custom handler)
- **Aspose.Total** (for file conversion & PDF processing)
- **Swagger / Swashbuckle** (API docs & testing)
- **Dependency Injection** (built-in)
- **File Upload & Storage** via `wwwroot/files`
- **Error Handling** using custom `ErrorResponseDto`

---

## ğŸš€ Features

- âœ… Upload and convert documents to PDF
- âœ… Supports: `.docx`, `.pdf`, `.xlsx`, `.txt`, `.png`, `.jpg`
- âœ… Add and store annotations
- âœ… Serve static files via a public URL
- âœ… IAM token-based authentication (via `Authorization` header)
- âœ… Clean separation of concerns & extensibility
- âœ… Full Swagger documentation

---

## ğŸ” Authentication

The API uses IAM tokens passed through the `Authorization` header:

```
Authorization: Bearer <user-token>
```

The token is validated by a custom `IamTokenAuthenticationHandler` middleware and injected into authorized endpoints.

---

## ğŸ› ï¸ How to Run the Project

1. **Clone the repo:**
   ```bash
   git clone https://github.com/your-org/document-services-api.git
   ```

2. **Restore packages:**
   ```bash
   dotnet restore
   ```

3. **Set `DocumentServices` as the startup project** (in Visual Studio or CLI):
   ```bash
   cd DocumentServices
   dotnet run
   ```

4. **Access Swagger:**
   ```
   https://localhost:5001/swagger
   ```

5. **Test APIs** by sending requests with a valid `Authorization` token.

---

## ğŸ“‚ Folder Highlights

- `wwwroot/files/` â€” Temp storage for converted PDFs.
- `Extensions/DependencyInjection.cs` â€” Central place for registering services and middleware.
- `Helpers/FileValidator.cs` â€” Validates base64 file content and format.
- `Dtos/` â€” Cleanly defined input and output models for APIs.

---

## ğŸ§ª Testing Endpoints

You can use:
- Swagger UI (auto-generated by Swashbuckle)
- Postman / Insomnia
- `curl` or other CLI tools

---

## ğŸ“Œ Known Issues

- The app throws an exception if `wwwroot/files` is missing. Make sure it's created before running.
- Conflicts can occur if multiple projects share the same static file with the same path â€” keep `wwwroot` only in `DocumentServices.Host`.

---

## ğŸ’¡ Future Enhancements

- JWT generation from IAM server (if needed)
- Centralized logging with Serilog or ELK
- Docker support
- Unit and integration test coverage

---

## ğŸ“„ License

This project is licensed for internal use. Contact the repository owner for reuse or distribution.
