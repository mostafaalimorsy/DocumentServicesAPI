
# 📄 Document Services API

A .NET 6-based backend service for uploading, converting, annotating, and retrieving documents (PDF, DOCX, XLSX, TXT, Images). The service authenticates users via IAM and uses token-based authorization for all endpoints.

---

## 📦 Project Structure (Clean Architecture)

This solution follows **Clean Architecture** principles and is organized by responsibility layers:

```
DocumentServices.sln
│
├── DocumentServices             # ASP.NET Core Web API (Presentation Layer)
├── DocumentServices.Application      # Application Layer (Services, Interfaces, DTOs, Business Logic)
├── DocumentServices.Domain           # Domain Layer (Entities, Enums, Core Abstractions)
└── DocumentServices.Infrastructure   # Infrastructure Layer (File System, IAM, Aspose, Validators, Repositories)
```

---

## 🧰 Technologies Used

- **.NET 6**
- **ASP.NET Core Web API**
- **IAM Token Authentication** (custom handler)
- **Aspose.Total** (for file conversion & PDF processing)
- **Swagger / Swashbuckle** (API docs & testing)
- **Dependency Injection** (built-in)
- **File Upload & Storage** via `wwwroot/files`
- **Error Handling** using custom `ErrorResponseDto`

---

## 🚀 Features

- ✅ Upload and convert documents to PDF
- ✅ Supports: `.docx`, `.pdf`, `.xlsx`, `.txt`, `.png`, `.jpg`
- ✅ Add and store annotations
- ✅ Serve static files via a public URL
- ✅ IAM token-based authentication (via `Authorization` header)
- ✅ Clean separation of concerns & extensibility
- ✅ Full Swagger documentation

---

## 🔐 Authentication

The API uses IAM tokens passed through the `Authorization` header:

```
Authorization: Bearer <user-token>
```

The token is validated by a custom `IamTokenAuthenticationHandler` middleware and injected into authorized endpoints.

---

## 🛠️ How to Run the Project

1. **Clone the repo:**
   ```bash
   git clone https://github.com/your-org/document-services-api.git
   ```

2. **Restore packages:**
   ```bash
   dotnet restore
   ```

3. **Set `DocumentServices` as the startup project** (in Visual Studio or CLI):
   ```bash
   cd DocumentServices
   dotnet run
   ```

4. **Access Swagger:**
   ```
   https://localhost:5001/swagger
   ```

5. **Test APIs** by sending requests with a valid `Authorization` token.

---

## 📂 Folder Highlights

- `wwwroot/files/` — Temp storage for converted PDFs.
- `Extensions/DependencyInjection.cs` — Central place for registering services and middleware.
- `Helpers/FileValidator.cs` — Validates base64 file content and format.
- `Dtos/` — Cleanly defined input and output models for APIs.

---

## 🧪 Testing Endpoints

You can use:
- Swagger UI (auto-generated by Swashbuckle)
- Postman / Insomnia
- `curl` or other CLI tools

---

## 📌 Known Issues

- The app throws an exception if `wwwroot/files` is missing. Make sure it's created before running.
- Conflicts can occur if multiple projects share the same static file with the same path — keep `wwwroot` only in `DocumentServices.Host`.

---

## 💡 Future Enhancements

- JWT generation from IAM server (if needed)
- Centralized logging with Serilog or ELK
- Docker support
- Unit and integration test coverage

---

## 📄 License

This project is licensed for internal use. Contact the repository owner for reuse or distribution.
